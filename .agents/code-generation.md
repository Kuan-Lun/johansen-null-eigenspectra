# Code Generation Guidelines

本文件為程式碼生成相關的 AI Agent 提供詳細指導。

## Rust 程式設計規範

### 基本原則

- 遵循 Rust 最佳實作和慣例
- 保持與現有程式碼庫風格的一致性
- 確保並行計算中的執行緒安全
- 遵循 SOLID 原則進行清潔和可維護的程式碼設計

### 程式碼註解規範

- 內部文件和程式碼註解使用繁體中文
- 使用者介面訊息、錯誤訊息和 CLI 輸出使用英文
- 函數和模組的文件註解（doc comments）使用英文

### 錯誤處理

- 使用合適的 Rust 錯誤處理模式（Result, Option）
- 為使用者提供有意義的英文錯誤訊息
- 為除錯記錄詳細的繁體中文錯誤資訊
- 在可能的地方實作優雅的錯誤復原

### 程式碼品質要求

- 提交前執行 `cargo fmt` 確保格式一致
- 使用 `cargo clippy` 捕獲常見錯誤並提高程式碼品質
- 確保所有程式碼通過 `cargo check` 且無警告
- 編寫自文件化的程式碼，使用清晰的變數和函數名

## 專案特定要求

### 統計計算

- 理解 Johansen 協整檢驗的統計性質
- 在特徵值計算中保持數值精度
- 使用一致的隨機種子確保模擬結果的可重複性
- 高效處理蒙特卡洛模擬的大規模資料

### 效能考慮

- 對計算密集型操作進行效能分析
- 最佳化大規模模擬的記憶體使用
- 在適用的地方考慮 SIMD 最佳化

### 依賴管理

- 保持依賴項的最新狀態並審核漏洞
- 使用最少的依賴項，優先選擇維護良好的 crate
- 審查依賴項許可證的相容性

## 實作指導

### 執行緒安全

- 在多執行緒環境中確保資料結構的安全存取
- 正確使用 Rust 的所有權系統避免資料競爭
- 優先使用 Rust 標準函式庫的並行原語

### 記憶體管理

- 避免不必要的記憶體分配
- 使用適當的資料結構最佳化記憶體配置
- 考慮使用 `Box`, `Rc`, `Arc` 等智慧指標的場景

### 模組設計

- 保持模組的單一職責
- 合理設計公共介面
- 使用適當的可見性修飾符
